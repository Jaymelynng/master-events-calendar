<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Bulk Event SQL Generator</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #fdf7f7 0%, #f5f1f1 50%, #f0ebeb 100%);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            background: linear-gradient(135deg, #b48f8f, #8f93a0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5rem;
            margin: 0;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .input-section, .output-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: 600;
            color: #4a4a4a;
            margin-bottom: 5px;
        }
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            box-sizing: border-box;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #b48f8f;
            box-shadow: 0 0 0 3px rgba(180, 143, 143, 0.1);
        }
        textarea {
            min-height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .generate-btn {
            background: linear-gradient(135deg, #b48f8f, #8f93a0);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 20px 0;
        }
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(180, 143, 143, 0.3);
        }
        .output-area {
            background: #f8f9fa;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            min-height: 300px;
        }
        .copy-btn {
            background: #22c55e;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }
        .gym-codes {
            background: #f0f9ff;
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ Bulk Event SQL Generator</h1>
        <p>Paste iClass Pro event data ‚Üí Get instant SQL for Supabase</p>
    </div>

    <div class="container">
        <div class="input-section">
            <h3>üìù Input Event Data</h3>
            
            <div class="form-group">
                <label for="gymCode">Gym Code:</label>
                <select id="gymCode">
                    <option value="">Select Gym</option>
                    <option value="CCP">Capital Cedar Park (CCP)</option>
                    <option value="CPF">Capital Pflugerville (CPF)</option>
                    <option value="CRR">Capital Round Rock (CRR)</option>
                    <option value="HGA">Houston Gymnastics Academy (HGA)</option>
                    <option value="RBA">Rowland Ballard Atascocita (RBA)</option>
                    <option value="RBK">Rowland Ballard Kingwood (RBK)</option>
                    <option value="EST">Estrella Gymnastics (EST)</option>
                    <option value="OAS">Oasis Gymnastics (OAS)</option>
                    <option value="SGT">Scottsdale Gymnastics (SGT)</option>
                    <option value="TIG">Tigar Gymnastics (TIG)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="eventType">Event Type:</label>
                <select id="eventType">
                    <option value="">Select Type</option>
                    <option value="OPEN GYM">Open Gym</option>
                    <option value="KIDS NIGHT OUT">Kids Night Out</option>
                    <option value="CLINIC">Clinic</option>
                </select>
            </div>

            <div class="form-group">
                <label for="eventData">Paste iClass Pro Event Data:</label>
                <textarea id="eventData" placeholder="Paste the event text from iClass Pro here...

Example:
Gym Fun Friday 9/5/25
Sep 5th, 2025 - Sep 5th, 2025
Fri| 10:00 AM - 11:30 AM

Kids Night Out 9/12/25  
Sep 12th, 2025 - Sep 12th, 2025
Fri| 6:30 PM - 9:30 PM"></textarea>
            </div>

            <div class="form-group">
                <label for="eventUrls">Paste URLs (one per line):</label>
                <textarea id="eventUrls" placeholder="Paste the registration URLs here (one per line)...

Example:
https://portal.iclasspro.com/capgymroundrock/camp-details/1576?typeId=35...
https://portal.iclasspro.com/capgymroundrock/camp-details/1580?typeId=35..."></textarea>
            </div>

            <button class="generate-btn" onclick="generateSQL()">üöÄ Generate SQL</button>
        </div>

        <div class="output-section">
            <h3>üìä Generated SQL</h3>
            <div id="sqlOutput" class="output-area">Your SQL will appear here...</div>
            <button class="copy-btn" onclick="copySQL()">üìã Copy SQL</button>
        </div>
    </div>

    <script>
        function generateSQL() {
            const gymCode = document.getElementById('gymCode').value;
            const eventType = document.getElementById('eventType').value;
            const eventData = document.getElementById('eventData').value;
            const eventUrls = document.getElementById('eventUrls').value.split('\n').filter(url => url.trim());

            if (!gymCode || !eventType || !eventData) {
                alert('Please fill in Gym Code, Event Type, and Event Data!');
                return;
            }

            const events = parseEventData(eventData, eventType, gymCode);
            const sql = generateSQLStatements(events, eventUrls);
            
            document.getElementById('sqlOutput').textContent = sql;
        }

        function parseEventData(data, eventType, gymCode) {
            const events = [];
            const lines = data.split('\n');
            let currentEvent = null;

            for (let line of lines) {
                line = line.trim();
                if (!line) continue;

                // Look for event titles (usually contain dates like 9/5/25)
                if (line.includes('/25') && !line.includes('Sep ') && !line.includes('|')) {
                    if (currentEvent) events.push(currentEvent);
                    currentEvent = {
                        title: line,
                        type: eventType,
                        gymCode: gymCode
                    };
                }
                // Look for date lines (Sep 5th, 2025)
                else if (line.includes('Sep ') && line.includes('2025')) {
                    if (currentEvent) {
                        const dateMatch = line.match(/Sep (\d+)/);
                        if (dateMatch) {
                            const day = dateMatch[1].padStart(2, '0');
                            currentEvent.date = `2025-09-${day}`;
                        }
                    }
                }
                // Look for time lines (Fri| 10:00 AM - 11:30 AM)
                else if (line.includes('|') && (line.includes('AM') || line.includes('PM'))) {
                    if (currentEvent) {
                        const timeMatch = line.match(/\|\s*(.+)/);
                        if (timeMatch) {
                            currentEvent.time = timeMatch[1].trim();
                            const dayMatch = line.match(/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun)/);
                            if (dayMatch) {
                                const dayMap = {
                                    'Mon': 'Monday', 'Tue': 'Tuesday', 'Wed': 'Wednesday',
                                    'Thu': 'Thursday', 'Fri': 'Friday', 'Sat': 'Saturday', 'Sun': 'Sunday'
                                };
                                currentEvent.dayOfWeek = dayMap[dayMatch[1]];
                            }
                        }
                    }
                }
            }
            
            if (currentEvent) events.push(currentEvent);
            return events;
        }

        function generateSQLStatements(events, urls) {
            if (events.length === 0) {
                return 'No events parsed. Please check your input format.';
            }

            let sql = `-- Bulk insert for ${events[0].gymCode} ${events[0].type} events\n`;
            sql += `-- Generated on ${new Date().toLocaleString()}\n\n`;
            
            sql += `INSERT INTO events (gym_id, title, date, time, day_of_week, type, event_url, price)\nVALUES\n`;

            const values = events.map((event, index) => {
                const url = urls[index] || 'NULL';
                const urlValue = url === 'NULL' ? 'NULL' : `'${url}'`;
                
                return `-- ${event.title}
(
    '${event.gymCode}',
    '${event.title}',
    '${event.date}',
    '${event.time}',
    '${event.dayOfWeek}',
    '${event.type}',
    ${urlValue},
    NULL
)`;
            });

            sql += values.join(',\n\n');
            sql += ';\n\n';
            
            sql += `-- Verify the insertions\n`;
            sql += `SELECT title, date, time, type, gym_id, event_url\n`;
            sql += `FROM events\n`;
            sql += `WHERE gym_id = '${events[0].gymCode}'\n`;
            sql += `    AND type = '${events[0].type}'\n`;
            sql += `    AND date >= '2025-09-01'\n`;
            sql += `    AND date <= '2025-09-30'\n`;
            sql += `ORDER BY date, time;`;

            return sql;
        }

        function copySQL() {
            const output = document.getElementById('sqlOutput');
            navigator.clipboard.writeText(output.textContent).then(() => {
                const btn = event.target;
                const oldText = btn.textContent;
                btn.textContent = '‚úÖ Copied!';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.textContent = oldText;
                    btn.style.background = '#22c55e';
                }, 2000);
            });
        }
    </script>
</body>
</html>

